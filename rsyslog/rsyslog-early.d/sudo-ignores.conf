#
# Don't log sudo messages generated by Icinga2 checks.
#

:msg, contains, "pam_unix(sudo:session): session closed for user root" ~
:msg, contains, "pam_unix(cron:session): session opened for user root by (uid=0)" ~
:msg, contains, "pam_unix(sudo:session): session opened for user root by (uid=0)" ~

# Interfaces
:msg, contains, "nagios : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/local/share/monitoring-plugins/check_ifupdown2" ~
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/sbin/ifquery -c -a" ~

# OSPF
:msg, contains, "nagios : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/local/share/monitoring-plugins/check_bird_ospf" ~
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/birdc show ospf neighbors" ~ 
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/birdc6 show ospf neighbors" ~
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/birdc show ospf interface" ~
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/birdc6 show ospf interface" ~

# BGP
:msg, contains, "nagios : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/local/share/monitoring-plugins/check_bird_bgp --asn 65132" ~
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/birdc show protocols all" ~ 
:msg, contains, "root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/sbin/birdc6 show protocols all" ~

# Conntrack
:msg, contains, "nagios : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/local/share/monitoring-plugins/check_conntrack_size" ~

# Mail
:msg, contains, "nagios : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/lib/nagios/plugins/check_mailq" ~
